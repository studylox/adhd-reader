{"ast":null,"code":"// 高亮颜色变量\nlet currentHighlightColor = '#ff0000'; // ADHD默认模式的红色\n\n// 模式切换\nfunction toggleMode(mode) {\n  const content = document.querySelector('.page-content');\n  if (mode === 'adhd') {\n    content.classList.add('adhd-default-mode');\n    currentHighlightColor = '#ff0000'; // ADHD模式下使用红色\n    setHighlightColor('#ff0000');\n  } else {\n    content.classList.remove('adhd-default-mode');\n  }\n}\n\n// 词性高亮\nfunction highlightByPOS(pos) {\n  const text = document.querySelector('.page-content');\n  const words = text.textContent.split(/\\s+/);\n\n  // 这里应该调用词性标注API\n  // 示例实现\n  words.forEach(word => {\n    const span = document.createElement('span');\n    span.textContent = word + ' ';\n    span.className = `pos-highlight ${pos}`;\n    text.appendChild(span);\n  });\n}\n\n// 自定义高亮\nfunction createHighlight(color) {\n  const selection = window.getSelection();\n  if (selection.toString().length > 0) {\n    const span = document.createElement('span');\n    span.className = 'highlight';\n    span.style.backgroundColor = color;\n    selection.getRangeAt(0).surroundContents(span);\n    saveHighlights();\n  }\n}\n\n// 保存高亮\nfunction saveHighlights() {\n  const highlights = Array.from(document.querySelectorAll('.highlight')).map(h => ({\n    text: h.textContent,\n    color: h.style.backgroundColor,\n    position: getElementPosition(h)\n  }));\n  localStorage.setItem('highlights', JSON.stringify(highlights));\n}\n\n// 加载高亮\nfunction loadHighlights() {\n  const highlights = JSON.parse(localStorage.getItem('highlights') || '[]');\n  highlights.forEach(h => {\n    const span = document.createElement('span');\n    span.className = 'highlight';\n    span.style.backgroundColor = h.color;\n    span.textContent = h.text;\n    // 根据position插入到正确位置\n    insertAtPosition(span, h.position);\n  });\n}\n\n// 获取元素位置\nfunction getElementPosition(element) {\n  const rect = element.getBoundingClientRect();\n  return {\n    top: rect.top,\n    left: rect.left,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\n// 在指定位置插入元素\nfunction insertAtPosition(element, position) {\n  // 实现插入逻辑\n}\n\n// 设置高亮颜色\nfunction setHighlightColor(color) {\n  currentHighlightColor = color;\n  document.documentElement.style.setProperty('--highlight-color', color);\n  // 更新所有现有高亮的颜色\n  document.querySelectorAll('.highlight').forEach(highlight => {\n    highlight.style.backgroundColor = color;\n  });\n}\n\n// 初始化阅读器\nfunction initializeReader() {\n  // 添加模式切换按钮\n  const modeControls = document.createElement('div');\n  modeControls.className = 'mode-controls';\n  modeControls.innerHTML = `\n    <button class=\"mode-btn\" onclick=\"window.toggleMode('adhd')\">ADHD模式</button>\n    <button class=\"mode-btn\" onclick=\"window.toggleMode('normal')\">普通模式</button>\n  `;\n  document.body.appendChild(modeControls);\n\n  // 添加词性选择器\n  const posSelector = document.createElement('div');\n  posSelector.className = 'pos-selector';\n  posSelector.innerHTML = `\n    <h3>选择词性高亮</h3>\n    <div class=\"pos-options\">\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"noun\" onchange=\"window.highlightByPOS(this.value)\"> 名词\n      </label>\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"verb\" onchange=\"window.highlightByPOS(this.value)\"> 动词\n      </label>\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"adjective\" onchange=\"window.highlightByPOS(this.value)\"> 形容词\n      </label>\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"adverb\" onchange=\"window.highlightByPOS(this.value)\"> 副词\n      </label>\n    </div>\n  `;\n  document.body.appendChild(posSelector);\n\n  // 添加颜色选择器\n  const colorPicker = document.createElement('div');\n  colorPicker.className = 'highlight-color-picker';\n  colorPicker.innerHTML = `\n    <h3>选择高亮颜色</h3>\n    <div class=\"color-options\">\n      <div class=\"color-option\" style=\"background-color: #ff0000\" onclick=\"window.setHighlightColor('#ff0000')\"></div>\n      <div class=\"color-option\" style=\"background-color: #00ff00\" onclick=\"window.setHighlightColor('#00ff00')\"></div>\n      <div class=\"color-option\" style=\"background-color: #0000ff\" onclick=\"window.setHighlightColor('#0000ff')\"></div>\n      <div class=\"color-option\" style=\"background-color: #ffff00\" onclick=\"window.setHighlightColor('#ffff00')\"></div>\n      <div class=\"color-option\" style=\"background-color: #ff00ff\" onclick=\"window.setHighlightColor('#ff00ff')\"></div>\n    </div>\n  `;\n  document.body.appendChild(colorPicker);\n\n  // 设置初始高亮颜色\n  setHighlightColor(currentHighlightColor);\n\n  // 添加文本选择事件监听器\n  const content = document.querySelector('.page-content');\n  content.addEventListener('mouseup', function (e) {\n    const selection = window.getSelection();\n    if (selection.toString().length > 0) {\n      createHighlight(currentHighlightColor);\n    }\n  });\n\n  // 加载保存的高亮\n  loadHighlights();\n}\n\n// 将函数暴露到全局作用域\nwindow.toggleMode = toggleMode;\nwindow.highlightByPOS = highlightByPOS;\nwindow.setHighlightColor = setHighlightColor;\nwindow.createHighlight = createHighlight;\nexport { initializeReader };","map":{"version":3,"names":["currentHighlightColor","toggleMode","mode","content","document","querySelector","classList","add","setHighlightColor","remove","highlightByPOS","pos","text","words","textContent","split","forEach","word","span","createElement","className","appendChild","createHighlight","color","selection","window","getSelection","toString","length","style","backgroundColor","getRangeAt","surroundContents","saveHighlights","highlights","Array","from","querySelectorAll","map","h","position","getElementPosition","localStorage","setItem","JSON","stringify","loadHighlights","parse","getItem","insertAtPosition","element","rect","getBoundingClientRect","top","left","width","height","documentElement","setProperty","highlight","initializeReader","modeControls","innerHTML","body","posSelector","colorPicker","addEventListener","e"],"sources":["D:/adhd-read-helper/src/utils/readerUtils.js"],"sourcesContent":["// 高亮颜色变量\nlet currentHighlightColor = '#ff0000'; // ADHD默认模式的红色\n\n// 模式切换\nfunction toggleMode(mode) {\n  const content = document.querySelector('.page-content');\n  if (mode === 'adhd') {\n    content.classList.add('adhd-default-mode');\n    currentHighlightColor = '#ff0000'; // ADHD模式下使用红色\n    setHighlightColor('#ff0000');\n  } else {\n    content.classList.remove('adhd-default-mode');\n  }\n}\n\n// 词性高亮\nfunction highlightByPOS(pos) {\n  const text = document.querySelector('.page-content');\n  const words = text.textContent.split(/\\s+/);\n  \n  // 这里应该调用词性标注API\n  // 示例实现\n  words.forEach(word => {\n    const span = document.createElement('span');\n    span.textContent = word + ' ';\n    span.className = `pos-highlight ${pos}`;\n    text.appendChild(span);\n  });\n}\n\n// 自定义高亮\nfunction createHighlight(color) {\n  const selection = window.getSelection();\n  if (selection.toString().length > 0) {\n    const span = document.createElement('span');\n    span.className = 'highlight';\n    span.style.backgroundColor = color;\n    selection.getRangeAt(0).surroundContents(span);\n    saveHighlights();\n  }\n}\n\n// 保存高亮\nfunction saveHighlights() {\n  const highlights = Array.from(document.querySelectorAll('.highlight')).map(h => ({\n    text: h.textContent,\n    color: h.style.backgroundColor,\n    position: getElementPosition(h)\n  }));\n  localStorage.setItem('highlights', JSON.stringify(highlights));\n}\n\n// 加载高亮\nfunction loadHighlights() {\n  const highlights = JSON.parse(localStorage.getItem('highlights') || '[]');\n  highlights.forEach(h => {\n    const span = document.createElement('span');\n    span.className = 'highlight';\n    span.style.backgroundColor = h.color;\n    span.textContent = h.text;\n    // 根据position插入到正确位置\n    insertAtPosition(span, h.position);\n  });\n}\n\n// 获取元素位置\nfunction getElementPosition(element) {\n  const rect = element.getBoundingClientRect();\n  return {\n    top: rect.top,\n    left: rect.left,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\n// 在指定位置插入元素\nfunction insertAtPosition(element, position) {\n  // 实现插入逻辑\n}\n\n// 设置高亮颜色\nfunction setHighlightColor(color) {\n  currentHighlightColor = color;\n  document.documentElement.style.setProperty('--highlight-color', color);\n  // 更新所有现有高亮的颜色\n  document.querySelectorAll('.highlight').forEach(highlight => {\n    highlight.style.backgroundColor = color;\n  });\n}\n\n// 初始化阅读器\nfunction initializeReader() {\n  // 添加模式切换按钮\n  const modeControls = document.createElement('div');\n  modeControls.className = 'mode-controls';\n  modeControls.innerHTML = `\n    <button class=\"mode-btn\" onclick=\"window.toggleMode('adhd')\">ADHD模式</button>\n    <button class=\"mode-btn\" onclick=\"window.toggleMode('normal')\">普通模式</button>\n  `;\n  document.body.appendChild(modeControls);\n\n  // 添加词性选择器\n  const posSelector = document.createElement('div');\n  posSelector.className = 'pos-selector';\n  posSelector.innerHTML = `\n    <h3>选择词性高亮</h3>\n    <div class=\"pos-options\">\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"noun\" onchange=\"window.highlightByPOS(this.value)\"> 名词\n      </label>\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"verb\" onchange=\"window.highlightByPOS(this.value)\"> 动词\n      </label>\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"adjective\" onchange=\"window.highlightByPOS(this.value)\"> 形容词\n      </label>\n      <label class=\"pos-option\">\n        <input type=\"checkbox\" value=\"adverb\" onchange=\"window.highlightByPOS(this.value)\"> 副词\n      </label>\n    </div>\n  `;\n  document.body.appendChild(posSelector);\n\n  // 添加颜色选择器\n  const colorPicker = document.createElement('div');\n  colorPicker.className = 'highlight-color-picker';\n  colorPicker.innerHTML = `\n    <h3>选择高亮颜色</h3>\n    <div class=\"color-options\">\n      <div class=\"color-option\" style=\"background-color: #ff0000\" onclick=\"window.setHighlightColor('#ff0000')\"></div>\n      <div class=\"color-option\" style=\"background-color: #00ff00\" onclick=\"window.setHighlightColor('#00ff00')\"></div>\n      <div class=\"color-option\" style=\"background-color: #0000ff\" onclick=\"window.setHighlightColor('#0000ff')\"></div>\n      <div class=\"color-option\" style=\"background-color: #ffff00\" onclick=\"window.setHighlightColor('#ffff00')\"></div>\n      <div class=\"color-option\" style=\"background-color: #ff00ff\" onclick=\"window.setHighlightColor('#ff00ff')\"></div>\n    </div>\n  `;\n  document.body.appendChild(colorPicker);\n\n  // 设置初始高亮颜色\n  setHighlightColor(currentHighlightColor);\n\n  // 添加文本选择事件监听器\n  const content = document.querySelector('.page-content');\n  content.addEventListener('mouseup', function(e) {\n    const selection = window.getSelection();\n    if (selection.toString().length > 0) {\n      createHighlight(currentHighlightColor);\n    }\n  });\n\n  // 加载保存的高亮\n  loadHighlights();\n}\n\n// 将函数暴露到全局作用域\nwindow.toggleMode = toggleMode;\nwindow.highlightByPOS = highlightByPOS;\nwindow.setHighlightColor = setHighlightColor;\nwindow.createHighlight = createHighlight;\n\nexport { initializeReader }; "],"mappings":"AAAA;AACA,IAAIA,qBAAqB,GAAG,SAAS,CAAC,CAAC;;AAEvC;AACA,SAASC,UAAUA,CAACC,IAAI,EAAE;EACxB,MAAMC,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAAC,eAAe,CAAC;EACvD,IAAIH,IAAI,KAAK,MAAM,EAAE;IACnBC,OAAO,CAACG,SAAS,CAACC,GAAG,CAAC,mBAAmB,CAAC;IAC1CP,qBAAqB,GAAG,SAAS,CAAC,CAAC;IACnCQ,iBAAiB,CAAC,SAAS,CAAC;EAC9B,CAAC,MAAM;IACLL,OAAO,CAACG,SAAS,CAACG,MAAM,CAAC,mBAAmB,CAAC;EAC/C;AACF;;AAEA;AACA,SAASC,cAAcA,CAACC,GAAG,EAAE;EAC3B,MAAMC,IAAI,GAAGR,QAAQ,CAACC,aAAa,CAAC,eAAe,CAAC;EACpD,MAAMQ,KAAK,GAAGD,IAAI,CAACE,WAAW,CAACC,KAAK,CAAC,KAAK,CAAC;;EAE3C;EACA;EACAF,KAAK,CAACG,OAAO,CAACC,IAAI,IAAI;IACpB,MAAMC,IAAI,GAAGd,QAAQ,CAACe,aAAa,CAAC,MAAM,CAAC;IAC3CD,IAAI,CAACJ,WAAW,GAAGG,IAAI,GAAG,GAAG;IAC7BC,IAAI,CAACE,SAAS,GAAG,iBAAiBT,GAAG,EAAE;IACvCC,IAAI,CAACS,WAAW,CAACH,IAAI,CAAC;EACxB,CAAC,CAAC;AACJ;;AAEA;AACA,SAASI,eAAeA,CAACC,KAAK,EAAE;EAC9B,MAAMC,SAAS,GAAGC,MAAM,CAACC,YAAY,CAAC,CAAC;EACvC,IAAIF,SAAS,CAACG,QAAQ,CAAC,CAAC,CAACC,MAAM,GAAG,CAAC,EAAE;IACnC,MAAMV,IAAI,GAAGd,QAAQ,CAACe,aAAa,CAAC,MAAM,CAAC;IAC3CD,IAAI,CAACE,SAAS,GAAG,WAAW;IAC5BF,IAAI,CAACW,KAAK,CAACC,eAAe,GAAGP,KAAK;IAClCC,SAAS,CAACO,UAAU,CAAC,CAAC,CAAC,CAACC,gBAAgB,CAACd,IAAI,CAAC;IAC9Ce,cAAc,CAAC,CAAC;EAClB;AACF;;AAEA;AACA,SAASA,cAAcA,CAAA,EAAG;EACxB,MAAMC,UAAU,GAAGC,KAAK,CAACC,IAAI,CAAChC,QAAQ,CAACiC,gBAAgB,CAAC,YAAY,CAAC,CAAC,CAACC,GAAG,CAACC,CAAC,KAAK;IAC/E3B,IAAI,EAAE2B,CAAC,CAACzB,WAAW;IACnBS,KAAK,EAAEgB,CAAC,CAACV,KAAK,CAACC,eAAe;IAC9BU,QAAQ,EAAEC,kBAAkB,CAACF,CAAC;EAChC,CAAC,CAAC,CAAC;EACHG,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEC,IAAI,CAACC,SAAS,CAACX,UAAU,CAAC,CAAC;AAChE;;AAEA;AACA,SAASY,cAAcA,CAAA,EAAG;EACxB,MAAMZ,UAAU,GAAGU,IAAI,CAACG,KAAK,CAACL,YAAY,CAACM,OAAO,CAAC,YAAY,CAAC,IAAI,IAAI,CAAC;EACzEd,UAAU,CAAClB,OAAO,CAACuB,CAAC,IAAI;IACtB,MAAMrB,IAAI,GAAGd,QAAQ,CAACe,aAAa,CAAC,MAAM,CAAC;IAC3CD,IAAI,CAACE,SAAS,GAAG,WAAW;IAC5BF,IAAI,CAACW,KAAK,CAACC,eAAe,GAAGS,CAAC,CAAChB,KAAK;IACpCL,IAAI,CAACJ,WAAW,GAAGyB,CAAC,CAAC3B,IAAI;IACzB;IACAqC,gBAAgB,CAAC/B,IAAI,EAAEqB,CAAC,CAACC,QAAQ,CAAC;EACpC,CAAC,CAAC;AACJ;;AAEA;AACA,SAASC,kBAAkBA,CAACS,OAAO,EAAE;EACnC,MAAMC,IAAI,GAAGD,OAAO,CAACE,qBAAqB,CAAC,CAAC;EAC5C,OAAO;IACLC,GAAG,EAAEF,IAAI,CAACE,GAAG;IACbC,IAAI,EAAEH,IAAI,CAACG,IAAI;IACfC,KAAK,EAAEJ,IAAI,CAACI,KAAK;IACjBC,MAAM,EAAEL,IAAI,CAACK;EACf,CAAC;AACH;;AAEA;AACA,SAASP,gBAAgBA,CAACC,OAAO,EAAEV,QAAQ,EAAE;EAC3C;AAAA;;AAGF;AACA,SAAShC,iBAAiBA,CAACe,KAAK,EAAE;EAChCvB,qBAAqB,GAAGuB,KAAK;EAC7BnB,QAAQ,CAACqD,eAAe,CAAC5B,KAAK,CAAC6B,WAAW,CAAC,mBAAmB,EAAEnC,KAAK,CAAC;EACtE;EACAnB,QAAQ,CAACiC,gBAAgB,CAAC,YAAY,CAAC,CAACrB,OAAO,CAAC2C,SAAS,IAAI;IAC3DA,SAAS,CAAC9B,KAAK,CAACC,eAAe,GAAGP,KAAK;EACzC,CAAC,CAAC;AACJ;;AAEA;AACA,SAASqC,gBAAgBA,CAAA,EAAG;EAC1B;EACA,MAAMC,YAAY,GAAGzD,QAAQ,CAACe,aAAa,CAAC,KAAK,CAAC;EAClD0C,YAAY,CAACzC,SAAS,GAAG,eAAe;EACxCyC,YAAY,CAACC,SAAS,GAAG;AAC3B;AACA;AACA,GAAG;EACD1D,QAAQ,CAAC2D,IAAI,CAAC1C,WAAW,CAACwC,YAAY,CAAC;;EAEvC;EACA,MAAMG,WAAW,GAAG5D,QAAQ,CAACe,aAAa,CAAC,KAAK,CAAC;EACjD6C,WAAW,CAAC5C,SAAS,GAAG,cAAc;EACtC4C,WAAW,CAACF,SAAS,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EACD1D,QAAQ,CAAC2D,IAAI,CAAC1C,WAAW,CAAC2C,WAAW,CAAC;;EAEtC;EACA,MAAMC,WAAW,GAAG7D,QAAQ,CAACe,aAAa,CAAC,KAAK,CAAC;EACjD8C,WAAW,CAAC7C,SAAS,GAAG,wBAAwB;EAChD6C,WAAW,CAACH,SAAS,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EACD1D,QAAQ,CAAC2D,IAAI,CAAC1C,WAAW,CAAC4C,WAAW,CAAC;;EAEtC;EACAzD,iBAAiB,CAACR,qBAAqB,CAAC;;EAExC;EACA,MAAMG,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAAC,eAAe,CAAC;EACvDF,OAAO,CAAC+D,gBAAgB,CAAC,SAAS,EAAE,UAASC,CAAC,EAAE;IAC9C,MAAM3C,SAAS,GAAGC,MAAM,CAACC,YAAY,CAAC,CAAC;IACvC,IAAIF,SAAS,CAACG,QAAQ,CAAC,CAAC,CAACC,MAAM,GAAG,CAAC,EAAE;MACnCN,eAAe,CAACtB,qBAAqB,CAAC;IACxC;EACF,CAAC,CAAC;;EAEF;EACA8C,cAAc,CAAC,CAAC;AAClB;;AAEA;AACArB,MAAM,CAACxB,UAAU,GAAGA,UAAU;AAC9BwB,MAAM,CAACf,cAAc,GAAGA,cAAc;AACtCe,MAAM,CAACjB,iBAAiB,GAAGA,iBAAiB;AAC5CiB,MAAM,CAACH,eAAe,GAAGA,eAAe;AAExC,SAASsC,gBAAgB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}